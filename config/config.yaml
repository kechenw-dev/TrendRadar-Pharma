# ========================================
# 医药行业信息采集系统 - 主配置文件
# 基于 TrendRadar v5.4.0
# 适用于14年医药供应链与采购总监
# ========================================

app:
  timezone: "Asia/Shanghai"
  version_check: true

# ========================================
# 推送报告配置
# ========================================
report:
  # 推送模式选择：
  # - daily: 每日汇总（推荐，包含当日所有匹配新闻）
  # - incremental: 仅新增（零重复，只在有新内容时推送）
  # - current: 当前榜单（实时排名，持续在榜的每次都会出现）
  mode: "daily"

  # 显示模式：
  # - keyword: 按关键词分组（推荐，便于按主题查看）
  # - platform: 按平台分组（便于对比不同平台）
  display_mode: "keyword"

  # 高亮阈值：排名前N的新闻会加粗显示
  rank_threshold: 5

  # 排序优先级：
  # - false: 按热度排序（热点多的排前面）
  # - true: 按配置顺序排序（保持词组优先级）
  sort_by_position_first: false

  # 每个关键词最多显示条数（0=不限制）
  max_news_per_keyword: 0

# ========================================
# 平台配置（热榜抓取）
# ========================================
platforms:
  enabled: true
  sources:
    - id: "baidu"
      name: "百度热搜"
    - id: "weibo"
      name: "微博热搜"
    - id: "toutiao"
      name: "今日头条"
    - id: "wallstreetcn-hot"
      name: "华尔街见闻"
    - id: "thepaper"
      name: "澎湃新闻"
    - id: "zhihu"
      name: "知乎热榜"
    # 可根据需要添加更多平台

# ========================================
# RSS 订阅配置（医药专业源）
# ========================================
rss:
  enabled: true
  feeds:
    # ============ 监管机构 ============
    - id: "fda-news"
      name: "FDA News Releases"
      url: "https://www.fda.gov/about-fda/fda-bureau-media-relations/rss-feeds/press-releases.xml"
      enabled: true

    - id: "ema-news"
      name: "EMA News"
      url: "https://www.ema.europa.eu/en/news/rss.xml"
      enabled: true

    # ============ 专业媒体 ============
    - id: "fierce-pharma"
      name: "FiercePharma"
      url: "https://www.fiercepharma.com/rss.xml"
      enabled: true

    - id: "pharmatimes"
      name: "PharmaTimes"
      url: "https://www.pharmatimes.com/rss"
      enabled: true

    - id: "biospace"
      name: "BioSpace"
      url: "https://www.biospace.com/rss/feed"
      enabled: true

    # ============ 国内专业媒体（需手动添加实际RSS URL）===========
    # - id: "ccpie"
    #   name: "中国医药保健品进出口商会"
    #   url: "https://www.cccpie.org/rss.xml"  # 示例，需替换
    #   enabled: false

# ========================================
# AI 分析配置
# ========================================
ai_analysis:
  enabled: true
  # 推送模式：
  # - only_analysis: 仅推送AI分析报告
  # - both: 原始内容 + AI分析报告（推荐）
  push_mode: "both"

  # AI 模型配置（基于 LiteLLM）
  model: "deepseek/deepseek-chat"  # 格式: provider/model
  api_key: "${AI_API_KEY}"         # 从环境变量读取
  api_base: ""                      # 留空使用默认，或填自定义API地址

  # 分析参数
  temperature: 1.0
  max_tokens: 5000
  timeout: 120
  num_retries: 2

# ========================================
# AI 翻译配置（可选）
# ========================================
ai_translation:
  enabled: false  # 如需翻译海外RSS内容，可设为 true
  language: "Chinese"
  batch_size: 10

# ========================================
# 通知渠道配置
# ========================================
notification:
  channels:
    # 企业微信机器人
    wework:
      enabled: true
      webhook_url: "${WEWORK_WEBHOOK_URL}"
      msg_type: "markdown"  # markdown: 富文本, text: 纯文本

    # 邮件推送
    email:
      enabled: true
      from: "${EMAIL_FROM}"
      password: "${EMAIL_PASSWORD}"
      to: "${EMAIL_TO}"
      smtp_server: ""  # 留空自动识别
      smtp_port: ""    # 留空自动识别

    # Telegram（可选）
    telegram:
      enabled: false
      bot_token: "${TELEGRAM_BOT_TOKEN}"
      chat_id: "${TELEGRAM_CHAT_ID}"

  # 推送时间窗口
  push_window:
    enabled: true
    start: "09:00"  # 开始时间（北京时间）
    end: "18:00"    # 结束时间（北京时间）
    once_per_day: false  # true: 每天只推送一次, false: 每次执行都推送

# ========================================
# 显示区域配置
# ========================================
display:
  regions:
    hotlist: true       # 热榜新闻
    rss: true           # RSS订阅
    new_items: true     # 新增热点
    standalone: false   # 独立展示区
    ai_analysis: true   # AI分析

  region_order:
    - ai_analysis       # AI分析放在最前面
    - hotlist
    - rss
    - new_items

# ========================================
# 存储配置
# ========================================
storage:
  # 本地存储
  local:
    path: "output"
    retention_days: 30  # 本地数据保留天数（0=永久）

  # 远程存储（GitHub Actions 用户建议配置）
  remote:
    backend: "auto"  # auto, s3, local
    retention_days: 30

  # 输出格式
  formats:
    sqlite: true
    html: true
    txt: false

# ========================================
# 高级配置
# ========================================
advanced:
  # 热点权重算法（三个数值相加必须等于1.0）
  weight:
    rank: 0.6      # 排名权重（越高越重视当前排名）
    frequency: 0.3 # 频次权重（越高越重视持续热度）
    hotness: 0.1   # 热度权重（平台热度值）

  # URL标准化（解决重复推送问题）
  normalize_url: true

  # 增量模式配置
  incremental_mode:
    history_hours: 24  # 历史追踪时长（小时）
